<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
  <ModulePrefs title="nagios system status" author="k4m6a7"/> 
  <UserPref name="user" display_name="Nagios Username" required="true"/>
  <UserPref name="pass" display_name="Nagios Password" required="true"/>
  <UserPref name="url" display_name="URL to Nagios statusjson.cgi" required="true"/>
  <UserPref name="host" display_name="Host Name" required="true"/>
  <UserPref name="service" display_name="Service Description" required="true"/>
  <Content type="html">
     <![CDATA[ 
     <script type="text/javascript">
         var user = prefs.getString("user");
         var pass = prefs.getString("pass"); 
         var url = prefs.getString("url");
         var host = prefs.getString("host");
         var service = prefs.getString("service");

         var request_uri = 'http://' + user + ':' + pass + '@' + url + '?query=service&hostname=' + host + '&servicedescription=' + service;

         _IG_RegisterOnloadHandler(function() {
             setTimeout(function() {
                 _IG_FetchContent(request_uri,
                                  function(response) {  
                                      _gel("body").innerHTML = response;
                                  }, 
                                  { refreshInterval: 0 });
             }, 15000);
         });
     </script>
     <div id="body"></div>
     ]]>
  </Content> 
</Module>
